2025-10-27 12:36:13,962 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-10-27 12:36:13,963 - quality_etl - INFO - Phase 1: Extraction
2025-10-27 12:36:13,963 - quality_etl - INFO - Starting database extraction
2025-10-27 12:36:14,043 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date >= CURRENT_DATE - INTERVAL '7 days'
                ORDER BY date
            
2025-10-27 12:36:14,119 - quality_etl - INFO - No new records to extract
2025-10-27 12:36:14,119 - quality_etl - INFO - No new data to process
2025-10-27 12:37:49,790 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-10-27 12:37:49,790 - quality_etl - INFO - Phase 1: Extraction
2025-10-27 12:37:49,790 - quality_etl - INFO - Starting database extraction
2025-10-27 12:37:49,865 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date >= CURRENT_DATE - INTERVAL '7 days'
                ORDER BY date
            
2025-10-27 12:37:49,928 - quality_etl - INFO - No new records to extract
2025-10-27 12:37:49,928 - quality_etl - INFO - No new data to process
2025-10-27 12:40:21,341 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-10-27 12:40:21,341 - quality_etl - INFO - Phase 1: Extraction
2025-10-27 12:40:21,342 - quality_etl - INFO - Starting database extraction
2025-10-27 12:40:21,415 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date >= CURRENT_DATE - INTERVAL '360 days'
                ORDER BY date
            
2025-10-27 12:40:21,479 - quality_etl - INFO - === SOURCE DATA COLUMN ANALYSIS ===
2025-10-27 12:40:21,485 - quality_etl - INFO - Column 'part_number': 118 unique values, samples: ['L002815065L43AF02', 'L002815555AL0AE03', 'L002815065L43AF02']
2025-10-27 12:40:21,486 - quality_etl - INFO - Column 'serial_number': 258 unique values, samples: ['L002815065L43AF02_S70049811005', 'L002815555AL0AE03_S70050760002', 'L002815065L43AF02_S70049811001']
2025-10-27 12:40:21,486 - quality_etl - INFO - Column 'date': 27 unique values, samples: [datetime.date(2025, 8, 26), datetime.date(2025, 8, 26), datetime.date(2025, 8, 26)]
2025-10-27 12:40:21,487 - quality_etl - INFO - Column 'shift': 2 unique values, samples: ['1', '1', '1']
2025-10-27 12:40:21,488 - quality_etl - INFO - Column 'disposition': 3 unique values, samples: ['Scrap', 'Repaired', 'Repaired']
2025-10-27 12:40:21,488 - quality_etl - INFO - Column 'code': 43 unique values, samples: ['A092', 'A119', 'A076']
2025-10-27 12:40:21,489 - quality_etl - INFO - Column 'code_description': 42 unique values, samples: ['TENSION NOK " LÂCHÉ"', "DÉFAUT TECHNOLOGIQUE(TISSU/CUIR ENDOMMAGÉ  À CAUSE DE L'AIGUILLE)", 'MANQUE PROFIL " NORMAL FORME"']
2025-10-27 12:40:21,490 - quality_etl - INFO - Column 'category': 1 unique values, samples: ['Sewing', 'Sewing', 'Sewing']
2025-10-27 12:40:21,490 - quality_etl - INFO - Column 'type': 1 unique values, samples: ['Final inspection', 'Final inspection', 'Final inspection']
2025-10-27 12:40:21,491 - quality_etl - INFO - Column 'who_made_it': 15 unique values, samples: ['1940219', '1940219', '1940219']
2025-10-27 12:40:21,491 - quality_etl - INFO - Column 'regist_by': 7 unique values, samples: ['1982735', '1938213', '1938213']
2025-10-27 12:40:21,492 - quality_etl - INFO - Column 'repair_by': 8 unique values, samples: ['1982735', '1937758', '1938546']
2025-10-27 12:40:21,492 - quality_etl - INFO - Column 'qua_auth': 8 unique values, samples: ['1982735', '1937758', '1938546']
2025-10-27 12:40:21,492 - quality_etl - INFO - Column 'prod_auth': 8 unique values, samples: ['1982735', '1937758', '1938546']
2025-10-27 12:40:21,494 - quality_etl - INFO - Column 'scrap_auth': 6 unique values, samples: ['1938213', '-', '-']
2025-10-27 12:40:21,494 - quality_etl - INFO - Column 'machine_no': 49 unique values, samples: ['SM-252', '9', '7']
2025-10-27 12:40:21,495 - quality_etl - INFO - Column 'oper_no': 38 unique values, samples: ['15', '9', '7']
2025-10-27 12:40:21,495 - quality_etl - INFO - Column 'defect_comment': 177 unique values, samples: ['90 A092 TENSION NOK " LÂCHÉ"', " CODE DESCRIPTION\n115 A119 DÉFAUT TECHNOLOGIQUE(TISSU/CUIR ENDOMMAGÉ  À CAUSE DE L'AIGUILLE)", '74 A076 MANQUE PROFIL " NORMAL FORME"']
2025-10-27 12:40:21,496 - quality_etl - INFO - Column 'repair_comment': 139 unique values, samples: ['CODE DESCRIPTION\nA065 CRAN MISS MATCH " DECALAGE DES CRANS"\n\n\n', "VVCODE DESCRIPTION\nA119 DÉFAUT TECHNOLOGIQUE(TISSU/CUIR ENDOMMAGÉ  À CAUSE DE L'AIGUILLE)V\n", 'COMMENT 74 A076 MANQUE PROFIL " NORMAL FORME"']
2025-10-27 12:40:21,528 - quality_etl - INFO - Extracted 276 new records
2025-10-27 12:40:21,528 - quality_etl - INFO - SOURCE machine_no sample: ['SM-252', '9', '7', '7', '5', '9', 'SM-252', '5', '1', '44']
2025-10-27 12:40:21,529 - quality_etl - INFO - SOURCE machine_not null count: 276
2025-10-27 12:40:21,529 - quality_etl - INFO - Phase 2: Transformation
2025-10-27 12:40:21,542 - quality_etl - INFO - Phase 3: Loading
2025-10-27 12:40:21,674 - quality_etl - INFO - Loaded 276 records to clean table
2025-10-27 12:40:21,677 - quality_etl - INFO - ETL metadata updated successfully
2025-10-27 12:40:21,680 - quality_etl - INFO - Marked staging records with batch_id 20251027_124021 as processed
2025-10-27 12:40:21,681 - quality_etl - INFO -  ETL Pipeline completed successfully!
2025-10-27 13:07:20,751 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-10-27 13:07:20,751 - quality_etl - INFO - Phase 1: Extraction
2025-10-27 13:07:20,752 - quality_etl - INFO - Starting database extraction
2025-10-27 13:07:20,826 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date > %s
                ORDER BY date
            
2025-10-27 13:07:20,995 - quality_etl - INFO - No new records to extract
2025-10-27 13:07:20,995 - quality_etl - INFO - No new data to process
2025-10-27 13:07:36,491 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-10-27 13:07:36,491 - quality_etl - INFO - Phase 1: Extraction
2025-10-27 13:07:36,491 - quality_etl - INFO - Starting database extraction
2025-10-27 13:07:36,567 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date > %s
                ORDER BY date
            
2025-10-27 13:07:36,748 - quality_etl - INFO - No new records to extract
2025-10-27 13:07:36,748 - quality_etl - INFO - No new data to process
2025-10-27 13:12:53,095 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-10-27 13:12:53,095 - quality_etl - INFO - Phase 1: Extraction
2025-10-27 13:12:53,095 - quality_etl - INFO - Starting database extraction
2025-10-27 13:12:53,169 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date >= CURRENT_DATE - INTERVAL '30 days'
                ORDER BY date
            
2025-10-27 13:12:53,231 - quality_etl - INFO - === SOURCE DATA COLUMN ANALYSIS ===
2025-10-27 13:12:53,232 - quality_etl - INFO - Column 'part_number': 110 unique values, samples: ['L003016124AR4AB', 'L003016124AR4AB', 'L003016124AR4AB']
2025-10-27 13:12:53,233 - quality_etl - INFO - Column 'serial_number': 321 unique values, samples: ['L003016124AR4AB_S70054233008', 'L003016124AR4AB_S70054233006', 'L003016124AR4AB_S70054233007']
2025-10-27 13:12:53,233 - quality_etl - INFO - Column 'date': 22 unique values, samples: [datetime.date(2025, 10, 1), datetime.date(2025, 10, 1), datetime.date(2025, 10, 1)]
2025-10-27 13:12:53,234 - quality_etl - INFO - Column 'shift': 2 unique values, samples: [2, 2, 2]
2025-10-27 13:12:53,235 - quality_etl - INFO - Column 'disposition': 3 unique values, samples: ['Scrap', 'Scrap', 'Scrap']
2025-10-27 13:12:53,235 - quality_etl - INFO - Column 'code': 50 unique values, samples: ['A055', 'A055', 'A007']
2025-10-27 13:12:53,236 - quality_etl - INFO - Column 'code_description': 50 unique values, samples: ['EMPIECEMENT ENDOMMAGÉ', 'EMPIECEMENT ENDOMMAGÉ', 'SURPIQUAGE SAMPLE IRRÉGULAIRE']
2025-10-27 13:12:53,236 - quality_etl - INFO - Column 'category': 1 unique values, samples: ['Sewing', 'Sewing', 'Sewing']
2025-10-27 13:12:53,237 - quality_etl - INFO - Column 'type': 2 unique values, samples: ['Final inspection', 'Final inspection', 'Final inspection']
2025-10-27 13:12:53,237 - quality_etl - INFO - Column 'who_made_it': 35 unique values, samples: ['1982735', '1982735', '1982735']
2025-10-27 13:12:53,238 - quality_etl - INFO - Column 'regist_by': 7 unique values, samples: ['1938546', '1938546', '1938546']
2025-10-27 13:12:53,239 - quality_etl - INFO - Column 'repair_by': 5 unique values, samples: ['-', '-', '-']
2025-10-27 13:12:53,240 - quality_etl - INFO - Column 'qua_auth': 6 unique values, samples: ['-', '-', '-']
2025-10-27 13:12:53,240 - quality_etl - INFO - Column 'prod_auth': 6 unique values, samples: ['-', '-', '-']
2025-10-27 13:12:53,241 - quality_etl - INFO - Column 'scrap_auth': 7 unique values, samples: ['1938546', '1938546', '1938546']
2025-10-27 13:12:53,241 - quality_etl - INFO - Column 'machine_no': 44 unique values, samples: ['SM-271', 'SM-270', 'SM-268']
2025-10-27 13:12:53,242 - quality_etl - INFO - Column 'oper_no': 31 unique values, samples: ['271', '7', '3']
2025-10-27 13:12:53,243 - quality_etl - INFO - Column 'defect_comment': 226 unique values, samples: ['90 A092 TENSION NOK " LÂCHÉ"\nOVER THKNS', '91 A093 TENSION  NOK "SERRÉ"\nOVER THKNS FHR', '90 A092 TENSION NOK " LÂCHÉ"\nOVER THKNS']
2025-10-27 13:12:53,243 - quality_etl - INFO - Column 'repair_comment': 156 unique values, samples: ['-', '-', '-']
2025-10-27 13:12:53,280 - quality_etl - INFO - Extracted 360 new records
2025-10-27 13:12:53,282 - quality_etl - INFO - SOURCE machine_no sample: ['SM-271', 'SM-270', 'SM-268', 'SM-257', 'SM-272', 'SM-164', 'SM-164', 'SM-232', 'SM-225', 'SM-269']
2025-10-27 13:12:53,282 - quality_etl - INFO - SOURCE machine_not null count: 360
2025-10-27 13:12:53,283 - quality_etl - INFO - Phase 2: Transformation
2025-10-27 13:12:53,293 - quality_etl - INFO - Phase 3: Loading
2025-10-27 13:12:53,452 - quality_etl - INFO - Loaded 360 records to clean table
2025-10-27 13:12:53,456 - quality_etl - INFO - ETL metadata updated successfully
2025-10-27 13:12:53,458 - quality_etl - INFO - Marked staging records with batch_id 20251027_131253 as processed
2025-10-27 13:12:53,458 - quality_etl - INFO -  ETL Pipeline completed successfully!
