2025-11-08 14:59:06,134 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-11-08 14:59:06,135 - quality_etl - INFO - Phase 1: Extraction
2025-11-08 14:59:06,135 - quality_etl - INFO - Starting database extraction
2025-11-08 14:59:06,219 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date > %s
                ORDER BY date
            
2025-11-08 14:59:06,293 - quality_etl - INFO - No new records to extract
2025-11-08 14:59:06,294 - quality_etl - INFO - No new data to process
2025-11-08 15:16:29,221 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-11-08 15:16:29,222 - quality_etl - INFO - Phase 1: Extraction
2025-11-08 15:16:29,222 - quality_etl - INFO - Starting database extraction
2025-11-08 15:16:29,309 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date > %s
                ORDER BY date
            
2025-11-08 15:16:29,381 - quality_etl - INFO - === SOURCE DATA COLUMN ANALYSIS ===
2025-11-08 15:16:29,383 - quality_etl - INFO - Column 'part_number': 53 unique values, samples: ['L002977270D6DAF', 'L002815585L42AH', 'L002836764L43AF']
2025-11-08 15:16:29,384 - quality_etl - INFO - Column 'serial_number': 181 unique values, samples: ['L002977270D6DAF_S70061709009', 'L002815585L42AH_S70059521006', 'L002836764L43AF_S70061881001']
2025-11-08 15:16:29,384 - quality_etl - INFO - Column 'date': 6 unique values, samples: [datetime.date(2025, 11, 1), datetime.date(2025, 11, 1), datetime.date(2025, 11, 1)]
2025-11-08 15:16:29,385 - quality_etl - INFO - Column 'shift': 2 unique values, samples: [1, 1, 1]
2025-11-08 15:16:29,385 - quality_etl - INFO - Column 'disposition': 3 unique values, samples: ['Repaired', 'Scrap', 'Repaired']
2025-11-08 15:16:29,386 - quality_etl - INFO - Column 'code': 40 unique values, samples: ['A002', 'A063', 'A079']
2025-11-08 15:16:29,386 - quality_etl - INFO - Column 'code_description': 40 unique values, samples: ["MANQUE POINT D'ARRÊT", "TROUS D'AIGUILLE", 'POSITION PROFIL ']
2025-11-08 15:16:29,386 - quality_etl - INFO - Column 'category': 1 unique values, samples: ['Sewing', 'Sewing', 'Sewing']
2025-11-08 15:16:29,387 - quality_etl - INFO - Column 'type': 1 unique values, samples: ['Final inspection', 'Final inspection', 'Final inspection']
2025-11-08 15:16:29,388 - quality_etl - INFO - Column 'who_made_it': 22 unique values, samples: ['1938827', '1938827', '1977912']
2025-11-08 15:16:29,388 - quality_etl - INFO - Column 'regist_by': 7 unique values, samples: ['1938546', '1938546', '1938546']
2025-11-08 15:16:29,389 - quality_etl - INFO - Column 'repair_by': 7 unique values, samples: ['1938546', '-', '1938546']
2025-11-08 15:16:29,389 - quality_etl - INFO - Column 'qua_auth': 8 unique values, samples: ['1938546', '-', '1938546']
2025-11-08 15:16:29,390 - quality_etl - INFO - Column 'prod_auth': 8 unique values, samples: ['1938546', '-', '1938546']
2025-11-08 15:16:29,391 - quality_etl - INFO - Column 'scrap_auth': 7 unique values, samples: ['-', '1938546', '-']
2025-11-08 15:16:29,392 - quality_etl - INFO - Column 'machine_no': 44 unique values, samples: ['SM-248', 'SM-231', 'SM-256']
2025-11-08 15:16:29,393 - quality_etl - INFO - Column 'oper_no': 43 unique values, samples: ['1', '231', '20']
2025-11-08 15:16:29,394 - quality_etl - INFO - Column 'defect_comment': 128 unique values, samples: ["2 A002 MANQUE POINT D'ARRÊT FSC 540/520", " CODE DESCRIPTION\r\n58 A063 TROUS D'AIGUILLE FSC 540/520", '72 A079 POSITION PROFIL  FSB']
2025-11-08 15:16:29,395 - quality_etl - INFO - Column 'repair_comment': 125 unique values, samples: ["2 A002 MANQUE POINT D'ARRÊT", '-', 'COMMENT 6 A007 SURPIQUAGE SAMPLE IRRÉGULAIRE FSB']
2025-11-08 15:16:29,425 - quality_etl - INFO - Extracted 215 new records
2025-11-08 15:16:29,425 - quality_etl - INFO - SOURCE machine_no sample: ['SM-248', 'SM-231', 'SM-256', 'SM-256', 'SM-263', 'SM-263', 'SM-263', 'SM-263', 'SM-263', 'SM-262']
2025-11-08 15:16:29,426 - quality_etl - INFO - SOURCE machine_not null count: 215
2025-11-08 15:16:29,426 - quality_etl - INFO - Phase 2: Transformation
2025-11-08 15:16:29,447 - quality_etl - INFO - Phase 3: Loading
2025-11-08 15:16:29,447 - quality_etl - INFO - Loading DataFrame with columns: ['part_number', 'serial_number', 'date', 'shift', 'disposition', 'code', 'code_description', 'category', 'type', 'machine_no', 'who_made_it', 'defect_comment', 'repair_comment', 'load_date', 'load_timestamp']
2025-11-08 15:16:29,448 - quality_etl - INFO - DataFrame shape: (215, 15)
2025-11-08 15:16:29,578 - quality_etl - INFO - Loaded 215 records to clean table
2025-11-08 15:16:29,583 - quality_etl - INFO - ETL metadata updated successfully
2025-11-08 15:16:29,591 - quality_etl - INFO - Marked staging records with batch_id 20251108_151629 as processed
2025-11-08 15:16:29,591 - quality_etl - INFO -  ETL Pipeline completed successfully!
2025-11-08 22:14:24,485 - quality_etl - INFO - === Starting ETL Pipeline ===
2025-11-08 22:14:24,487 - quality_etl - INFO - Phase 1: Extraction
2025-11-08 22:14:24,487 - quality_etl - INFO - Starting database extraction
2025-11-08 22:14:24,561 - quality_etl - INFO - Executing incremental extraction query: 
                SELECT * FROM lpb_quality_data 
                WHERE date > %s
                ORDER BY date
            
2025-11-08 22:14:24,634 - quality_etl - INFO - No new records to extract
2025-11-08 22:14:24,634 - quality_etl - INFO - No new data to process
